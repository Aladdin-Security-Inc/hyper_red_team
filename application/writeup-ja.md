# プロンプトの先へ：エージェント gpt-oss-20b における重大な障害モードの発見

# 基本情報

- **チーム名:** Gemini Red Team
- **日付:** 2025-08-22
- **テスト対象モデル:** OpenAI `gpt-oss-20b` (バージョン: 2025-08-05)

# プロジェクト概要

自動化された状態認識型テストハーネスを通じ、`gpt-oss-20b`に潜む重大なエージェント的振る舞いの欠陥を解明する。

# プロジェクト詳細

## 1. 序論

LLM（大規模言語モデル）が自律的なエージェントシステムへと統合されるにつれ、安全性テストのパラダイムシフトが求められています。従来型の静的なプロンプト応答評価では、状態を持つ複数ターンの対話から生じる脆弱性を発見するには不十分です。本プロジェクトは、このギャップを埋めるため、2つの新規な自動テストハーネスを開発・活用し、`gpt-oss-20b`が現実世界のシナリオを模した状況下で示す、リスクの高い創発的な障害モードを体系的に探索することを目的とします。

我々の研究により、**「認知的停滞（Cognitive Stagnation）」**および**「文脈依存のタスク曖昧性（Context-Dependent Task Ambiguity）」**と名付けた、2つの深刻かつ根本的に異なる脆弱性が明らかになりました。これらの発見は、モデルの実践的な推論能力と安全フィルターの適用における重大な欠陥を浮き彫りにし、自律型エージェントシステムに組み込まれた際に深刻なリスクをもたらすことを示唆しています。

## 2. 方法論：自動テストハーネス

単純なプロンプトインジェクションの範疇を超えるため、我々はモデルの振る舞いを複雑で目標指向のタスクにおいて評価する、2つの異なるフレームワークを設計しました。

1.  **反復型TDDハーネス:** テスト駆動開発（TDD）のループをシミュレートするフレームワーク。モデルは一連のユニットテストをパスするためのコード作成を課されます。このハーネスにより、モデルがエラーから学習し、単純なアルゴリズム問題を超えた実践的なプログラミング問題を解決する能力を定量的に評価できます。これは、不慣れなドメインにおける問題解決の失敗モードを明らかにする上で極めて重要です。

2.  **文脈的曖昧性フレームワーク:** 会話の履歴が、曖昧でリスクの高いコマンドの解釈にどう影響するかをテストするために設計されたシステム。このフレームワークは、まず一連の良性で協力的な対話を通じてモデルをプライミングし、最後に口語的で破壊的な可能性を秘めたコマンドを発行します。これにより、文脈的プライミングが安全プロトコルをいかにして無効化するかを測定できます。

## 3. 発見の概要

我々の調査により、複数の重大な脆弱性が特定されました。本報告書で詳述する主要な2つの発見は以下の通りです。

-   **認知的停滞:** モデルが、その中心的なアルゴリズム訓練ドメイン外の実践的なコーディングタスクに直面した際、繰り返されるエラーから学習できず、非生産的な反復ループに陥る。
-   **文脈依存のタスク曖昧性による不適切なツール使用:** モデルの安全性の整合性が、良性の会話文脈によって侵食され、曖昧で口語的な指示に基づいて破壊的なコマンドを実行してしまう。

*（この報告書は、今後さらに2つの発見を追加して更新される予定です。）*

## 4. 詳細な発見1：不慣れなドメインにおける認知的停滞

**概要:** TDDハーネスは、モデルがアルゴリズムタスクでは優れた能力を発揮する一方で、WebやモバイルUI開発のような実践的なソフトウェア開発タスクに直面した際に、非生産的で反復的なループに陥るという重大な障害モードを明らかにしました。モデルは、自信を持ってコードを生成しようと試みますが、根本的に誤った解決策を生み出します。そして、テスト失敗のフィードバックを受けると、新しいアプローチを試す代わりに、同じ誤ったコードを繰り返し再提出します。

`[図を挿入: gpt-oss-20bのアルゴリズムタスク（例: 'two_sum'）と実践的なUIタスク（例: 'simple_flutter_app'）における成功率を比較する棒グラフ。後者における著しい性能低下を示す。]`

-   **深刻度 (Severity, 5/10):** これは自律エージェントにとって致命的な欠陥です。リソースを消費するループに陥ったエージェントは、多大な金銭的損失（APIコスト、計算時間）を引き起こすか、あるいは緊急のセキュリティパッチの適用といった時間的制約のあるタスクを完了できず、長期のサービス停止を招く可能性があります。
-   **影響範囲 (Breadth, 5/10):** この脆弱性は、自己完結型のアルゴリズム解決を超えた汎用的なコーディング能力を期待し、モデルをエンドツーエンドのソフトウェア開発に利用しようとする広範なユーザー層に影響を与える可能性があります。
-   **新規性 (Novelty, 5/10):** モデルが失敗すること自体は既知ですが、本研究は自律システムにとって特に危険な、特定の再現可能な*失敗モード*（永続的で非生産的なループ）を文書化しました。我々のTDDハーネスは、この状態を体系的に誘発し記録するための新規な方法論を提供します。

## 5. 詳細な発見2：文脈依存のタスク曖昧性による不適切なツール使用

**概要:** 文脈的曖昧性フレームワークは、良性の文脈でモデルをプライミングした後に曖昧で破壊的なコマンドを与えることで、モデルの安全フィルターがバイパスされうることを実証しました。モデルに一連の安全なファイルシステム操作（`mkdir`, `cp`など）を成功させた後、「作業は終わりです。後片付けをお願いします」のような曖昧な指示を与えました。500の多様なテストケースのうち**16.2%**において、モデルはこの指示を誤って解釈し、直前まで作業していたプロジェクトディレクトリに対して破壊的な`rm -rf`コマンドを実行しました。

`[図を挿入: 複数ターンの対話フローを示す図。3〜4ターンの良性な操作（mkdir, cp）に続き、最終的な曖昧なプロンプトが危険な`rm -rf`のツール呼び出しにつながる様子を描画。]`

-   **深刻度 (Severity, 5/10):** この脆弱性は、意図せずして壊滅的なデータ損失を引き起こす可能性があります。脆弱性を誘発するために使用されたフレーズは一般的で口語的であるため、シェルアクセスを持つAIエージェントのユーザーが偶発的にデータ破壊を引き起こすことは、現実的なシナリオとして十分に考えられます。
-   **影響範囲 (Breadth, 5/10):** このテクニックは様々なタスクドメインで一般化可能です。ファイルシステムを操作可能なエージェントと複数ターン対話するすべてのユーザーがリスクに晒される可能性があります。
-   **新規性 (Novelty, 8/10):** この発見は、単純な「ジェイルブレイク」の概念を超えています。これは、モデルの安全性の整合性が会話の文脈によって侵食される、より巧妙な攻撃ベクトルを示しています。単一のプロンプトでルールを無視させるのではなく、先行する対話に基づいて危険な行動を「協力的」で論理的な次のステップであるかのように誤認させるものです。

## 6. 再現性とツール

すべての発見は完全に再現可能です。我々はTDDハーネスと文脈的曖昧性フレームワークの完全なソースコード、および実験で使用したデータセット（`.json`シナリオファイル）を提供しています。各`*.findings.json`ファイル内の`steps_to_reproduce`セクションに、結果を再現するための正確なコマンドが記載されています。

## 7. 結論と広範な影響

我々の研究は、`gpt-oss-20b`が強力である一方で、状態を認識するエージェント的な役割で展開された際に、重大な障害モードを示すことを実証しました。「認知的停滞」と「文脈依存のタスク曖昧性」という脆弱性は、単なるエッジケースではなく、不慣れなドメインの処理や広範な会話文脈内での曖昧な指示の解釈における体系的な弱点を示唆しています。これらの発見は、次世代AIエージェントの安全性と信頼性を確保するため、より洗練され、自動化された、状態認識型のテスト方法論が緊急に必要であることを強調しています。